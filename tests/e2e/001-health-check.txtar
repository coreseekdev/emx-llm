# Test health check endpoint

# Start gateway server in background
exec emx-gate &
sleep 4s

# Test health endpoint returns OK
exec curl --noproxy "*" -s http://127.0.0.1:8848/health
stdout 'status'
stdout 'ok'

# Clean up - use PowerShell to kill the process
[windows] ? exec powershell.exe -Command "Stop-Process -Name emx-gate -Force -ErrorAction SilentlyContinue"
[unix] ? exec pkill -f emx-gate
