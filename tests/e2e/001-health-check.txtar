# Test health check endpoint

# Start gateway server in background
exec emx-gate &
sleep 2s

# Test health endpoint returns OK
exec curl -s http://127.0.0.1:8848/health
stdout '"status":"ok"'
stdout 'timestamp'

# Test health endpoint structure
exec curl -s http://127.0.0.1:8848/health
grep -o '"status":"ok"'
stdout '"status":"ok"'

# Clean up: stop the server
[unix] exec pkill -f emx-gate
[windows] exec taskkill //F //IM emx-gate.exe
